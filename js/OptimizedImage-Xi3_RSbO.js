import{j as e}from"./index-BdoiUTHg.js";import{r as t}from"./react-vendor-DtX1tuCI.js";const s=({src:s,alt:r,className:a="",width:n,height:i,priority:o=!1,sizes:c="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",placeholder:l,onLoad:h,onError:u})=>{const[d,m]=t.useState(!1),[g,p]=t.useState(o),[w,f]=t.useState(!1),x=t.useRef(null),y=t.useRef(null);t.useEffect(()=>{if(o)return;const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(p(!0),e.disconnect())})},{rootMargin:"50px",threshold:.1});return y.current&&e.observe(y.current),()=>e.disconnect()},[o]);const b=(e,t="original")=>{if(e.startsWith("http")){const s=new URL(e);return"webp"===t&&s.searchParams.set("fm","webp"),s.searchParams.set("auto","compress"),s.searchParams.set("cs","tinysrgb"),n&&s.searchParams.set("w",n.toString()),i&&s.searchParams.set("h",i.toString()),s.toString()}return e},j=e=>{if(e.startsWith("http")){const t=new URL(e);t.searchParams.set("auto","compress"),t.searchParams.set("cs","tinysrgb");return[400,800,1200,1600].map(e=>{const s=new URL(t);return s.searchParams.set("w",e.toString()),`${s.toString()} ${e}w`}).join(", ")}return e};return w?e.jsx("div",{className:`bg-gray-800 flex items-center justify-center ${a}`,style:{width:n,height:i},children:e.jsx("span",{className:"text-gray-400 text-sm",children:"Failed to load image"})}):e.jsxs("div",{ref:y,className:`relative overflow-hidden ${a}`,style:{width:n,height:i},children:[!d&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-800 to-gray-900 animate-pulse flex items-center justify-center",children:l?e.jsx("img",{src:l,alt:"",className:"w-full h-full object-cover opacity-50 blur-sm"}):e.jsx("div",{className:"w-8 h-8 border-2 border-blue-400 border-t-transparent rounded-full animate-spin"})}),g&&e.jsxs("picture",{children:[e.jsx("source",{srcSet:j(b(s,"webp")),sizes:c,type:"image/webp"}),e.jsx("img",{ref:x,src:b(s),srcSet:j(s),sizes:c,alt:r,width:n,height:i,loading:o?"eager":"lazy",decoding:"async",onLoad:()=>{m(!0),null==h||h()},onError:()=>{f(!0),null==u||u()},className:`\n              w-full h-full object-cover transition-opacity duration-300\n              ${d?"opacity-100":"opacity-0"}\n              ${a}\n            `,style:{willChange:d?"auto":"opacity"}})]})]})};export{s as O};
